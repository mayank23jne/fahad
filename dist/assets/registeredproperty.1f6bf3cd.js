import{D as H}from"./KTDataTable.c04eda30.js";import{u as j}from"./survey.6b7b571f.js";import{h as O}from"./dom.d7d6c49b.js";import{S as $}from"./sweetalert2.all.fbc178e9.js";import{d as E,r as u,u as L,G as w,_ as M,k as _,l as t,I as d,m as i,y as c,ae as x,p as k,n as p,F as A,J as P,x as G,H as g,B as D,o as J,V as U}from"./index.40c6202a.js";const z=E({name:"add-registeredproperty-modal",components:{},props:["registeredproperty","units","propertytype","clientname"],setup(e,{emit:a}){const b=u(null),C=u(null),S=u(!1);u(!1);const N=localStorage.getItem("lang"),f=localStorage.getItem("logged_user_id"),{t:V,te:h}=L(),o=v=>h(v)?V(v):v,n=u({building_number:"",unittype:"",building_name:"",owner:"",client_id:"",permitno:"",representative:"",fields:[{id:1,list:"",noofpeople:""}]}),T=u({unittype:[{required:!0,message:o("reqselectproperty"),trigger:"change"}],owner:[{required:!0,message:o("owner_req"),trigger:"change"}],permitno:[{required:!0,message:o("permitnoreq"),trigger:"change"}]});return{newItem:n,rules:T,submit:()=>{!b.value||(e.registeredproperty,b.value.validate(v=>{v&&(console.log("name_en",n.value.building_number,"permitno",n.value.permitno,"representative",n.value.representative,"unittype",n.value.unittype),S.value=!0,w.post("createRegisteredProperty",{building_number:n.value.building_number,building_name:n.value.building_name,owner:n.value.owner,permitno:n.value.permitno,representative:n.value.representative,client_id:n.value.client_id,unittype:n.value.unittype,fields:n.value.fields,user_id:f}).then(({data:r})=>{console.log("submitdata",r),e.registeredproperty.push({created_at:r.created_at,id:r.id,is_deleted:r.is_deleted,building_no:r.building_no,building_name:r.building_name,owner:r.owner,permitno:r.permitno,representative:r.representative,unitid:r.unitid,status:"1",updated_at:r.updated_at,user_id:r.user_id}),setTimeout(()=>{var R;S.value=!1,(R=b.value)==null||R.resetFields(),$.fire({text:o("savesuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:o("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{O(C.value)})},2e3)}).catch(({response:r})=>{}))}))},formRef:b,loading:S,addregisteredpropertyModalRef:C,translate:o,deletefields:(v,r)=>{n.value.fields.splice(r,1)},lang:N,add:()=>{n.value.fields.push({id:n.value.fields.length+1,list:"",noofpeople:""})},onChangeSelect:v=>{e.units.map((r,R)=>{r.id===v&&(n.value.building_number=r.building_number,n.value.building_name=r.building_name,n.value.client_id=r.client_id,n.value.permitno=r.permissions,n.value.representative=r.representative,e.clientname.map((l,m)=>{l.id===Number(r.client_id)&&(n.value.owner=l.fullName)}))})}}}}),K={class:"modal fade",id:"kt_modal_add_registeredproperty",ref:"addregisteredpropertyModalRef",tabindex:"-1","aria-hidden":"true"},Q={class:"modal-dialog modal-dialog-centered mw-650px"},X={class:"modal-content"},Y={class:"modal-header",id:"kt_modal_add_customer_header"},Z={class:"fw-bold"},ee={id:"kt_modal_add_registeredproperty_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},te={class:"svg-icon svg-icon-1"},se={class:"modal-body py-10 px-lg-17"},oe={class:"scroll-y me-n7 pe-7",id:"kt_modal_add_industrytype_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_add_registeredproperty_header","data-kt-scroll-wrappers":"#kt_modal_add_registeredproperty_scroll","data-kt-scroll-offset":"300px"},ne={class:"row mb-7"},le={class:"col-lg-4 required fs-6 fw-semobold mb-2"},ae={class:"col-lg-8 fv-row"},re={class:"row mb-7"},ie={class:"col-lg-4 required fs-6 fw-semobold mb-2"},de={class:"col-lg-8 fv-row"},ce={class:"row mb-7"},ue={class:"col-lg-4 required fs-6 fw-semobold mb-2"},me={class:"col-lg-8 fv-row"},pe={class:"row mb-7"},ge={class:"col-lg-4 required fs-6 fw-semobold mb-2"},fe={class:"col-lg-8 fv-row"},_e={class:"row mb-7"},be={class:"col-lg-4 required fs-6 fw-semobold mb-2"},he={class:"col-lg-8 fv-row"},ve={class:"fv-row mb-4 text-right",style:{"margin-left":"77%"}},ye={class:"svg-icon svg-icon-3"},we={class:"row mb-4"},ke={class:"col-lg-4 required fs-6 fw-semobold mb-2"},$e={class:"col-lg-8 fv-row"},Ce={class:"row mb-4"},Se={class:"col-lg-4 required fs-6 fw-semobold mb-2"},Ve={class:"col-lg-8 fv-row"},Be=["onClick"],Ie=t("i",{class:"fa fa-trash me-1 fs-5"},null,-1),Ne=[Ie],Te={class:"modal-footer flex-center"},qe={type:"reset",id:"kt_modal_add_registeredproperty_cancel",class:"btn btn-light me-3"},Re=["data-kt-indicator"],Ae={key:0,class:"indicator-label"},De={class:"svg-icon svg-icon-3 ms-2 me-0"},Pe={key:1,class:"indicator-progress"},Ue=t("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function Ee(e,a,b,C,S,N){const f=k("inline-svg"),V=k("el-option"),h=k("el-select"),o=k("el-form-item"),n=k("el-input"),T=k("el-form");return p(),_("div",K,[t("div",Q,[t("div",X,[t("div",Y,[t("h2",Z,d(e.translate("addregisteredproperty")),1),t("div",ee,[t("span",te,[i(f,{src:"/media/icons/duotune/arrows/arr061.svg"})])])]),i(T,{onSubmit:a[7]||(a[7]=x(s=>e.submit(),["prevent"])),model:e.newItem,rules:e.rules,ref:"formRef"},{default:c(()=>[t("div",se,[t("div",oe,[t("div",ne,[t("label",le,d(e.translate("selectpropertytype")),1),t("div",ae,[i(o,{prop:"unittype"},{default:c(()=>[i(h,{modelValue:e.newItem.unittype,"onUpdate:modelValue":a[0]||(a[0]=s=>e.newItem.unittype=s),options:e.units,onChange:a[1]||(a[1]=s=>e.onChangeSelect(s)),"popper-append-to-body":!1,teleported:!1},{default:c(()=>[(p(!0),_(A,null,P(e.units,s=>(p(),G(V,{key:s.id,value:s.id,label:s.building_number},{default:c(()=>[g(d(s.building_number),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","options"])]),_:1})])]),t("div",re,[t("label",ie,d(e.translate("buildingname")),1),t("div",de,[i(o,{prop:"buildingname"},{default:c(()=>[i(n,{modelValue:e.newItem.building_name,"onUpdate:modelValue":a[2]||(a[2]=s=>e.newItem.building_name=s),type:"text",name:"buildingname",placeholder:""},null,8,["modelValue"])]),_:1})])]),t("div",ce,[t("label",ue,d(e.translate("owner")),1),t("div",me,[i(o,{prop:"owner"},{default:c(()=>[i(n,{modelValue:e.newItem.owner,"onUpdate:modelValue":a[3]||(a[3]=s=>e.newItem.owner=s),type:"text",name:"owner",placeholder:""},null,8,["modelValue"])]),_:1})])]),t("div",pe,[t("label",ge,d(e.translate("representative")),1),t("div",fe,[i(o,{prop:"representative"},{default:c(()=>[i(n,{modelValue:e.newItem.representative,"onUpdate:modelValue":a[4]||(a[4]=s=>e.newItem.representative=s),type:"text",name:"representative",placeholder:""},null,8,["modelValue"])]),_:1})])]),t("div",_e,[t("label",be,d(e.translate("licenseno")),1),t("div",he,[i(o,{prop:"permitno"},{default:c(()=>[i(n,{modelValue:e.newItem.permitno,"onUpdate:modelValue":a[5]||(a[5]=s=>e.newItem.permitno=s),type:"text",name:"permitno",placeholder:""},null,8,["modelValue"])]),_:1})])]),t("div",ve,[t("button",{type:"button",class:"btn btn-sm btn-flex btn-light-primary",onClick:a[6]||(a[6]=(...s)=>e.add&&e.add(...s))},[t("span",ye,[i(f,{src:"/media/icons/duotune/general/gen035.svg"})]),g(" "+d(e.translate("addfields")),1)])]),(p(!0),_(A,null,P(e.newItem.fields,(s,q)=>(p(),_("div",{key:q},[t("div",we,[t("label",ke,d(e.translate("list")),1),t("div",$e,[i(o,{prop:"list"},{default:c(()=>[i(n,{modelValue:s.list,"onUpdate:modelValue":B=>s.list=B,type:"text",name:"list",placeholder:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]),t("div",Ce,[t("label",Se,d(e.translate("noofpeople")),1),t("div",Ve,[i(o,{prop:"noofpeople"},{default:c(()=>[i(n,{modelValue:s.noofpeople,"onUpdate:modelValue":B=>s.noofpeople=B,type:"text",name:"noofpeople",placeholder:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]),t("span",{class:"badge badge-pill mb-5",style:{"margin-left":"93%"},onClick:B=>e.deletefields(s.id,q)},Ne,8,Be)]))),128))])]),t("div",Te,[t("button",qe,d(e.translate("cancel")),1),t("button",{"data-kt-indicator":e.loading?"on":null,class:"btn btn-lg btn-primary",type:"submit"},[e.loading?D("",!0):(p(),_("span",Ae,[g(d(e.translate("save"))+" ",1),t("span",De,[i(f,{src:"/media/icons/duotune/arrows/arr064.svg"})])])),e.loading?(p(),_("span",Pe,[g(d(e.translate("pleasewait"))+" ",1),Ue])):D("",!0)],8,Re)])]),_:1},8,["model","rules"])])])],512)}const Le=M(z,[["render",Ee]]),Me=E({name:"registeredproperty",components:{Datatable:H,RegisteredPropertyAddNewModal:Le},setup(){const e=u([{columnName:"buildingno",columnLabel:"buildingno",sortEnabled:!0,columnWidth:175},{columnName:"buildingname",columnLabel:"buildingname",sortEnabled:!0,columnWidth:175},{columnName:"owner",columnLabel:"owner",sortEnabled:!0,columnWidth:175},{columnName:"representative",columnLabel:"representative",sortEnabled:!0,columnWidth:175},{columnName:"licenseno",columnLabel:"licenseno",sortEnabled:!0,columnWidth:175},{columnName:"status",columnLabel:"status",sortEnabled:!0,columnWidth:50},{columnName:"action",columnLabel:"action",sortEnabled:!0,columnWidth:175}]),a=u([]);u(!0);const b=u([]),C=u([]),S=localStorage.getItem("lang"),N=u([]),f=u([]),V=u("");j();const h=localStorage.getItem("logged_user_id"),o=u({id:0,fullName:""}),{t:n,te:T}=L(),s=l=>T(l)?n(l):l;return J(()=>{w.post("showRegisteredProperty",{user_id:h}).then(({data:l})=>{a.value=l}).catch(({response:l})=>{}),w.get("showClients").then(({data:l})=>{o.value=l.data.map(m=>({fullName:`${m.firstname} ${m.lastname}`,id:m.id}))}),w.post("showPropertyType",{user_id:h}).then(({data:l})=>{f.value=l}).catch(({response:l})=>{}),w.get("showUnits").then(({data:l})=>{console.log("units",l),l&&(b.value=l.data)}).catch(({response:l})=>{})}),{lang:S,selectedItems:N,registeredproperty:a,selectedIds:C,onItemSelect:l=>{C.value=l},tableHeader:e,translate:s,deleterow:l=>{$.fire({title:s("areyousure"),text:s("notretrivedata"),icon:"warning",buttonsStyling:!1,showCancelButton:!0,confirmButtonText:s("yesdelete"),cancelButtonText:s("nocancel"),heightAuto:!1,customClass:{confirmButton:"btn btn-danger m-2",cancelButton:"btn btn-primary m-2"}}).then(m=>{m.value==!0?w.delete("deleteRegisteredProperty/"+l).then(({data:y})=>{a.value=a.value.filter(I=>I.id!==l),setTimeout(()=>{$.fire({text:s("deletesuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:s("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{})},2e3)}):setTimeout(()=>{$.fire({text:s("cancelerror"),icon:"success",buttonsStyling:!1,confirmButtonText:s("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{})},2e3)})},editrow:l=>{U.push({name:"editregisteredproperty",params:{id:l}})},edit_id:V,statuschange:(l,m)=>{let y="0";l=="0"?y="1":y="0",w.post("statusRegisteredProperty",{status:y,id:m}).then(({data:I})=>{setTimeout(()=>{$.fire({text:s("savedsuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:s("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{U.go(0)})},2e3)})},archivechange:(l,m)=>{$.fire({title:s("areyousure"),icon:"warning",buttonsStyling:!1,showCancelButton:!0,confirmButtonText:s("yesarchive"),cancelButtonText:s("nocancel"),heightAuto:!1,customClass:{confirmButton:"btn btn-danger m-2",cancelButton:"btn btn-primary m-2"}}).then(y=>{if(y.value==!0){let I="0";l=="0"?I="1":I="0",w.post("isDeletedRegisteredProperty",{delete:I,id:m}).then(({data:lt})=>{a.value=a.value.filter(F=>F.id!==m),setTimeout(()=>{$.fire({text:s("savedsuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:s("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{})},2e3)})}else setTimeout(()=>{$.fire({text:s("cancelerror"),icon:"success",buttonsStyling:!1,confirmButtonText:s("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{})},2e3)})},showData:l=>{let m=l.target.value;return w.post("archiveRegisteredProperty",{val:m,user_id:h}).then(({data:y})=>{a.value=y}).catch(({response:y})=>{})},propertytype:f,units:b,clientname:o}}}),We={class:"card"},Fe={class:"card-header border-0 pt-6"},He=t("div",{class:"card-title"},null,-1),je={class:"card-toolbar"},Oe={key:0,class:"d-flex justify-content-end","data-kt-customer-table-toolbar":"base"},xe={class:"d-flex flex-wrap my-1"},Ge={class:"m-0"},Je={class:"symbol symbol-20px me-4",value:"0",selected:""},ze={value:"1"},Ke={type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#kt_modal_add_registeredproperty"},Qe={class:"svg-icon svg-icon-2"},Xe=t("div",{class:"d-flex justify-content-end align-items-center d-none","data-kt-customer-table-toolbar":"selected"},[t("div",{class:"fw-bold me-5"},[t("span",{class:"me-2","data-kt-customer-table-select":"selected_count"}),g("Selected ")]),t("button",{type:"button",class:"btn btn-danger","data-kt-customer-table-select":"delete_selected"}," Delete Selected ")],-1),Ye={class:"card-body pt-0"},Ze=["onClick"],et=["onClick"],tt=["onClick"],st=["onClick"],ot=["onClick"];function nt(e,a,b,C,S,N){const f=k("inline-svg"),V=k("Datatable"),h=k("RegisteredPropertyAddNewModal");return p(),_(A,null,[t("div",We,[t("div",Fe,[He,t("div",je,[e.selectedIds.length===0?(p(),_("div",Oe,[t("div",xe,[t("div",Ge,[t("select",{name:"status","data-control":"select2","data-hide-search":"true",class:"form-select form-select-white form-select-sm fw-bold w-150px h-30px w-md-150px h-md-40px mr-2",onChange:a[0]||(a[0]=o=>e.showData(o)),style:{"margin-right":"20px","margin-left":"20px"}},[t("option",Je,d(e.translate("active")),1),t("option",ze,d(e.translate("archive")),1)],32)])]),t("button",Ke,[t("span",Qe,[i(f,{src:"/media/icons/duotune/arrows/arr075.svg"})]),g(" "+d(e.translate("addnew")),1)])])):D("",!0),Xe])]),t("div",Ye,[i(V,{onOnItemsSelect:e.onItemSelect,data:e.registeredproperty,header:e.tableHeader,"enable-items-per-page-dropdown":!0,"checkbox-enabled":!0,"checkbox-label":"id"},{buildingno:c(({row:o})=>[g(d(o.building_no),1)]),buildingname:c(({row:o})=>[g(d(o.building_name),1)]),owner:c(({row:o})=>[g(d(o.owner),1)]),representative:c(({row:o})=>[g(d(o.representative),1)]),licenseno:c(({row:o})=>[g(d(o.permitno),1)]),status:c(({row:o})=>[o.status==1?(p(),_("i",{key:0,class:"fa fa-unlock text-success fs-3","aria-hidden":"true",onClick:n=>e.statuschange(o.status,o.id)},null,8,Ze)):(p(),_("i",{key:1,class:"fa fa-lock text-danger fs-3","aria-hidden":"true",onClick:n=>e.statuschange(o.status,o.id)},null,8,et))]),action:c(({row:o})=>[t("i",{class:"fa fa-archive text-warning fs-3 m-2","aria-hidden":"true",onClick:n=>e.archivechange(o.is_deleted,o.id)},null,8,tt),t("i",{class:"fa fa-pencil text-primary fs-3 m-2","aria-hidden":"true",onClick:n=>e.editrow(o.id)},null,8,st),t("i",{class:"fa fa-trash text-danger fs-3 m-2","aria-hidden":"true",onClick:n=>e.deleterow(o.id)},null,8,ot)]),_:1},8,["onOnItemsSelect","data","header"])])]),i(h,{registeredproperty:e.registeredproperty,propertytype:e.propertytype,units:e.units,clientname:e.clientname},null,8,["registeredproperty","propertytype","units","clientname"])],64)}const ut=M(Me,[["render",nt]]);export{ut as default};
