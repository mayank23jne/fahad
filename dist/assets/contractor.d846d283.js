import{D as R}from"./KTDataTable.c04eda30.js";import{C as U}from"./ContractorAddNewModal.3571f9db.js";import{h as W}from"./dom.d7d6c49b.js";import{S as M}from"./sweetalert2.all.fbc178e9.js";import{d as N,r as c,u as T,o as V,_ as A,k as f,l as e,I as u,m as i,y as w,ae as j,p as b,n as h,H as C,B as D,G as B,V as q,ao as H,F}from"./index.40c6202a.js";import{a as G}from"./index.30a6773f.js";import"./ContractorAddNewModal.vue_vue_type_script_lang.69821714.js";const P=N({name:"edit-contractor-modal",components:{},props:["items","id","editdata"],emit:["update"],setup(t,{emit:n}){c([t.items]);const{t:$,te:I}=T(),_=c(null),v=c(null),s=c(!1);c(!1);const m=c({company_name:"",id:""}),p=k=>I(k)?$(k):k,g=c({company_name:[{required:!0,message:p("reqcon"),trigger:"change"}]});return V(async()=>{m.value.company_name=await t.editdata.company_name}),{cancelprocess:()=>{m.value.company_name="",W(v.value)},savecontractor:()=>{!_.value||_.value.validate(k=>{k&&(s.value=!0)})},rules:g,formRef:_,loading:s,editContractorModalRef:v,translate:p,company:m}}}),z={class:"modal fade",id:"kt_modal_edit_contractor",ref:"editContractorModalRef",tabindex:"-1","aria-hidden":"true"},J={class:"modal-dialog modal-dialog-centered mw-650px"},K={class:"modal-content"},Q={class:"modal-header",id:"kt_modal_add_customer_header"},X={class:"fw-bold"},Y={id:"kt_modal_edit_contractor_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},Z={class:"svg-icon svg-icon-1"},x={class:"modal-body py-10 px-lg-17"},tt={class:"scroll-y me-n7 pe-7",id:"kt_modal_edit_contractor_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_edit_contractor_header","data-kt-scroll-wrappers":"#kt_modal_edit_contractor_scroll","data-kt-scroll-offset":"300px"},et={class:"fv-row mb-7"},ot={class:"required fs-6 fw-semobold mb-2"},at={class:"modal-footer flex-center"},st=["data-kt-indicator"],nt={key:0,class:"indicator-label"},lt={class:"svg-icon svg-icon-3 ms-2 me-0"},ct={key:1,class:"indicator-progress"},rt=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function dt(t,n,$,I,_,v){const s=b("inline-svg"),m=b("el-input"),p=b("el-form-item"),g=b("el-form");return h(),f("div",z,[e("div",J,[e("div",K,[e("div",Q,[e("h2",X,u(t.translate("editcontractor")),1),e("div",Y,[e("span",Z,[i(s,{src:"/media/icons/duotune/arrows/arr061.svg"})])])]),i(g,{onSubmit:n[3]||(n[3]=j(o=>t.savecontractor(),["prevent"])),model:t.company,rules:t.rules,ref:"formRef"},{default:w(()=>[e("div",x,[e("div",tt,[e("div",et,[e("label",ot,u(t.translate("contractorname")),1),i(p,{prop:"company_name"},{default:w(()=>[i(m,{modelValue:t.company.company_name,"onUpdate:modelValue":n[0]||(n[0]=o=>t.company.company_name=o),type:"text",name:"company_name",placeholder:t.translate("placecontractor")},null,8,["modelValue","placeholder"])]),_:1}),i(p,{prop:"id"},{default:w(()=>[i(m,{modelValue:t.company.id,"onUpdate:modelValue":n[1]||(n[1]=o=>t.company.id=o),type:"hidden",name:"id",placeholder:t.translate("placecontractor")},null,8,["modelValue","placeholder"])]),_:1})])])]),e("div",at,[e("button",{type:"reset",id:"kt_modal_edit_contractor_cancel",class:"btn btn-light me-3",onClick:n[2]||(n[2]=(...o)=>t.cancelprocess&&t.cancelprocess(...o))},u(t.translate("cancel")),1),e("button",{"data-kt-indicator":t.loading?"on":null,class:"btn btn-lg btn-primary",type:"submit"},[t.loading?D("",!0):(h(),f("span",nt,[C(u(t.translate("save"))+" ",1),e("span",lt,[i(s,{src:"/media/icons/duotune/arrows/arr064.svg"})])])),t.loading?(h(),f("span",ct,[C(" Please wait... "),rt])):D("",!0)],8,st)])]),_:1},8,["model","rules"])])])],512)}const it=A(P,[["render",dt]]),mt=N({name:"contractor",components:{Datatable:R,ContractorAddNewModal:U,EditContractorModal:it},setup(){const{t,te:n}=T(),$=c(""),I=c([{columnName:"serialno",columnLabel:"id",sortEnabled:!0,columnWidth:175},{columnName:"contractorname",columnLabel:"company_name",sortEnabled:!0,columnWidth:230},{columnName:"status",columnLabel:"status",sortEnabled:!0,columnWidth:50},{columnName:"action",columnLabel:"action",sortEnabled:!0,columnWidth:170}]),_=c([]),v=c({}),s=c([]);V(()=>{B.get("showCompanies").then(({data:a})=>{s.value=a.data})});const m=(a,r)=>{let d="0";a=="0"?d="1":d="0",B.post("statusCompany",{status:d,id:r}).then(({data:S})=>{setTimeout(()=>{M.fire({text:l("savedsuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:l("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{q.go(0)})},2e3)})},p=a=>{let r=a.target.value;return B.post("archiveCompany",{val:r}).then(({data:d})=>{s.value=d.data}).catch(({response:d})=>{})},g=(a,r)=>{let d="0";a=="0"?d="1":d="0",B.post("isDeletedCompany",{delete:d,id:r}).then(({data:S})=>{s.value=s.value.filter(O=>O.id!==r),setTimeout(()=>{M.fire({text:l("savedsuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:l("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{})},2e3)})},o=a=>{$.value=a,B.get("showCompanyId",a).then(({data:S})=>{console.log("edit",S),v.value=S.company_name});const r=document.getElementById("kt_modal_edit_contractor");new H(r).show()},y=a=>{M.fire({title:l("areyousure"),text:l("notretrivedata"),icon:"warning",buttonsStyling:!1,showCancelButton:!0,confirmButtonText:l("yesdelete"),cancelButtonText:l("nocancel"),heightAuto:!1,customClass:{confirmButton:"btn btn-danger",cancelButton:"btn btn-primary"}}).then(r=>{r.value==!0?B.delete("deleteCompany/"+a).then(({data:d})=>{s.value=s.value.filter(S=>S.id!==a),setTimeout(()=>{M.fire({text:l("deletesuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:l("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{})},2e3)}):setTimeout(()=>{M.fire({text:l("cancelerror"),icon:"success",buttonsStyling:!1,confirmButtonText:l("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{})},2e3)})},k=c(""),E=a=>{const r=a.order==="asc";a.label&&G(s.value,a.label,{reverse:r})},L=a=>{_.value=a},l=a=>n(a)?t(a):a;return{tableData:s,tableHeader:I,search:k,selectedIds:_,sort:E,onItemSelect:L,translate:l,deleterow:y,editrow:o,statuschange:m,archivechange:g,showData:p,editid:$,editdata:v,updateItem:()=>{}}}}),ut={class:"card"},pt={class:"card-header border-0 pt-6"},_t=e("div",{class:"card-title"},null,-1),ft={class:"card-toolbar"},ht={key:0,class:"d-flex justify-content-end","data-kt-customer-table-toolbar":"base"},bt={class:"symbol symbol-20px me-4",value:"0",selected:""},vt={value:"1"},gt={type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#kt_modal_add_contractor"},yt={class:"svg-icon svg-icon-2"},kt={key:1,class:"d-flex justify-content-end align-items-center","data-kt-customer-table-toolbar":"selected"},wt={class:"fw-bold me-5"},Ct={class:"me-2"},$t=e("div",{class:"d-flex justify-content-end align-items-center d-none","data-kt-customer-table-toolbar":"selected"},[e("div",{class:"fw-bold me-5"},[e("span",{class:"me-2","data-kt-customer-table-select":"selected_count"}),C("Selected ")]),e("button",{type:"button",class:"btn btn-danger","data-kt-customer-table-select":"delete_selected"}," Delete Selected ")],-1),St={class:"card-body pt-0"},Bt=["onClick"],It=["onClick"],Mt=["onClick"],Dt=["onClick"],Nt=["onClick"];function Tt(t,n,$,I,_,v){const s=b("inline-svg"),m=b("Datatable"),p=b("ContractorAddNewModal"),g=b("EditContractorModal");return h(),f(F,null,[e("div",ut,[e("div",pt,[_t,e("div",ft,[t.selectedIds.length===0?(h(),f("div",ht,[e("select",{name:"status","data-control":"select2","data-hide-search":"true",class:"form-select form-select-white form-select-sm fw-bold w-150px h-30px w-md-150px h-md-40px mr-2",onChange:n[0]||(n[0]=o=>t.showData(o)),style:{"margin-right":"20px","margin-left":"20px"}},[e("option",bt,u(t.translate("active")),1),e("option",vt,u(t.translate("archive")),1)],32),e("button",gt,[e("span",yt,[i(s,{src:"/media/icons/duotune/arrows/arr075.svg"})]),C(" "+u(t.translate("newcontractor")),1)])])):(h(),f("div",kt,[e("div",wt,[e("span",Ct,u(t.selectedIds.length),1),C("Selected ")])])),$t])]),e("div",St,[i(m,{onOnSort:t.sort,onOnItemsSelect:t.onItemSelect,data:t.tableData,header:t.tableHeader,"enable-items-per-page-dropdown":!0},{id:w(({row:o})=>[C(u(o.id),1)]),company_name:w(({row:o})=>[C(u(o.company_name),1)]),status:w(({row:o})=>[o.status==1?(h(),f("i",{key:0,class:"fa fa-unlock text-success fs-3","aria-hidden":"true",onClick:y=>t.statuschange(o.status,o.id)},null,8,Bt)):(h(),f("i",{key:1,class:"fa fa-lock text-danger fs-3","aria-hidden":"true",onClick:y=>t.statuschange(o.status,o.id)},null,8,It))]),action:w(({row:o})=>[e("i",{class:"fa fa-archive text-warning fs-3 m-2","aria-hidden":"true",onClick:y=>t.archivechange(o.is_deleted,o.id)},null,8,Mt),e("i",{class:"fa fa-pencil text-primary fs-3 m-2","aria-hidden":"true",onClick:y=>t.editrow(o.id)},null,8,Dt),e("i",{class:"fa fa-trash text-danger fs-3 m-2","aria-hidden":"true",onClick:y=>t.deleterow(o.id)},null,8,Nt)]),_:1},8,["onOnSort","onOnItemsSelect","data","header"])])]),i(p,{items:t.tableData},null,8,["items"]),i(g,{items:t.tableData,id:t.editid,editdata:t.editdata&&t.editdata,onUpdate:t.updateItem},null,8,["items","id","editdata","onUpdate"])],64)}const jt=A(mt,[["render",Tt]]);export{jt as default};
