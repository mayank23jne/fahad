import{d as P,ac as T,ab as R,aA as E,u as M,r as p,o as D,G as _,V as j,_ as G,k as b,l as e,m as a,y as I,p as h,n as g,I as r,F as q,J as C,H as $}from"./index.40c6202a.js";import{S as H}from"./sweetalert2.all.fbc178e9.js";import{c as J,a as S}from"./object.fb242430.js";const L=P({name:"editindustrytype",props:["id"],components:{ErrorMessage:T,Field:R,VForm:E},setup(o){const{t:n,te:k}=M(),u=p(null),f=localStorage.getItem("logged_user_id"),w=p([]),d=p([]),c=p([]),t=p({building_number:"",building_name:"",owner:"",client_id:"",unittype:"",permitno:"",representative:"",fields:[]}),y=localStorage.getItem("lang"),l=s=>k(s)?n(s):s,m=p({id:0,fullName:""}),v=()=>{t.value.fields.push({id:t.value.fields.length+1,property_list:"",no_of_people:""})},F=(s,i)=>{t.value.fields.splice(i,1)},U=J().shape({unittype:S().required(l("reqselectproperty")),permitno:S().required(l("permitnoreq"))});D(()=>{_.post("showRegisteredPropertyId",{id:o.id,user_id:f}).then(({data:s})=>{t.value.unittype=s[0].unitid,t.value.building_number=s[0].building_no,t.value.building_name=s[0].building_name,t.value.owner=s[0].owner,t.value.client_id=s[0].client_id,t.value.permitno=s[0].permitno,t.value.representative=s[0].representative}),_.post("showRegisteredFieldbyProperty",{id:o.id,user_id:f}).then(({data:s})=>{t.value.fields=s}),_.get("showUnits").then(({data:s})=>{d.value=s.data}).catch(({response:s})=>{}),_.post("showPropertyType",{user_id:f}).then(({data:s})=>{w.value=s}).catch(({response:s})=>{}),_.get("showClients").then(({data:s})=>{console.log("sjow",s.data),m.value=s.data.map(i=>({fullName:`${i.firstname} ${i.lastname}`,id:i.id})),c.value.push(m.value)})});const N=s=>{d.value.map((i,He)=>{i.id===Number(s.target.value)&&(t.value.building_number=i.building_number,t.value.building_name=i.building_name,t.value.client_id=i.client_id,t.value.permitno=i.permissions,t.value.representative=i.representative,c.value[0].map((V,Je)=>{V.id===Number(i.client_id)&&(console.log("fullname",V.fullName),t.value.owner=V.fullName)}))})},A=()=>{u.value&&(u.value.setAttribute("data-kt-indicator","on"),setTimeout(()=>{var s;(s=u.value)==null||s.removeAttribute("data-kt-indicator")},2e3))},B=()=>{u.value&&(u.value.setAttribute("data-kt-indicator","on"),_.post("updateRegisteredProperty",{building_number:t.value.building_number,unittype:t.value.unittype,building_name:t.value.building_name,client_id:t.value.client_id,owner:t.value.owner,permitno:t.value.permitno,representative:t.value.representative,fields:t.value.fields,user_id:f,id:o.id}).then(({data:s})=>{setTimeout(()=>{H.fire({text:l("savedsuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:l("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{j.push({name:"registeredproperty"})})},2e3)}),setTimeout(()=>{var s;(s=u.value)==null||s.removeAttribute("data-kt-indicator")},2e3))};return p(""),{submitButton1:u,saveChanges1:A,newItem:t,formSubmit:B,profileDetailsValidator:U,translate:l,property_type:w,lang:y,add:v,deletefields:F,onChangeSelect:N,units:d}}});const z={class:"card mb-5 mb-xl-10"},K={id:"kt_account_profile_details",class:"collapse show"},O={class:"card-body border-top p-9"},Q={class:"row mb-6"},W={class:"col-lg-4 col-form-label required fw-semobold fs-6"},X={class:"col-lg-8 fv-row"},Y=["value"],Z={class:"fv-plugins-message-container"},x={class:"fv-help-block"},ee={class:"row mb-6"},oe={class:"col-lg-4 col-form-label required fw-semobold fs-6"},se={class:"col-lg-8"},te={class:"fv-plugins-message-container"},le={class:"fv-help-block"},ne={class:"row mb-6"},ae={class:"col-lg-4 col-form-label required fw-semobold fs-6"},ie={class:"col-lg-8 fv-row"},re={class:"fv-plugins-message-container"},de={class:"fv-help-block"},ce={class:"row mb-6"},me={class:"col-lg-4 col-form-label required fw-semobold fs-6"},ue={class:"col-lg-8 fv-row"},pe={class:"fv-plugins-message-container"},ve={class:"fv-help-block"},_e={class:"row mb-6"},fe={class:"col-lg-4 col-form-label required fw-semobold fs-6"},be={class:"col-lg-8"},ge={class:"fv-plugins-message-container"},he={class:"fv-help-block"},we={class:"text-right mb-2"},ye={class:"svg-icon svg-icon-3"},Ve={class:"row mb-6"},ke={class:"col-lg-4 col-form-label required fw-semobold fs-6"},Ie={class:"col-lg-8 fv-row"},qe={class:"fv-plugins-message-container"},Ce={class:"fv-help-block"},$e={class:"row mb-6"},Se={class:"col-lg-4 col-form-label required fw-semobold fs-6"},Fe={class:"col-lg-8 fv-row"},Ue={class:"fv-plugins-message-container"},Ne={class:"fv-help-block"},Ae=["onClick"],Be=e("i",{class:"fa fa-trash me-1 fs-5"},null,-1),Pe=[Be],Te={class:"card-footer d-flex justify-content-end py-6 px-9"},Re={type:"reset",class:"btn btn-light btn-active-light-primary me-2"},Ee={type:"submit",id:"kt_account_profile_details_submit",ref:"submitButton1",class:"btn btn-primary"},Me={class:"indicator-label"},De={class:"indicator-progress"},je=e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function Ge(o,n,k,u,f,w){const d=h("Field"),c=h("ErrorMessage"),t=h("inline-svg"),y=h("VForm");return g(),b("div",z,[e("div",K,[a(y,{id:"kt_account_profile_details_form",class:"form",novalidate:"",onSubmit:n[6]||(n[6]=l=>o.formSubmit()),"validation-schema":o.profileDetailsValidator},{default:I(()=>[e("div",O,[e("div",Q,[e("label",W,r(o.translate("selectpropertytype")),1),e("div",X,[a(d,{as:"select",name:"unittype",class:"form-select form-select-solid form-select-lg",modelValue:o.newItem.unittype,"onUpdate:modelValue":n[0]||(n[0]=l=>o.newItem.unittype=l),options:o.units,onChange:o.onChangeSelect},{default:I(()=>[(g(!0),b(q,null,C(o.units,l=>(g(),b("option",{key:l.id,value:l.id},r(l.building_number),9,Y))),128))]),_:1},8,["modelValue","options","onChange"]),e("div",Z,[e("div",x,[a(c,{name:"unittype"})])])])]),e("div",ee,[e("label",oe,r(o.translate("buildingname")),1),e("div",se,[a(d,{type:"text",name:"buildingname",class:"form-control form-control-lg form-control-solid mb-3 mb-lg-0",placeholder:o.translate("buildingname"),modelValue:o.newItem.building_name,"onUpdate:modelValue":n[1]||(n[1]=l=>o.newItem.building_name=l)},null,8,["placeholder","modelValue"]),e("div",te,[e("div",le,[a(c,{name:"buildingname"})])])])]),e("div",ne,[e("label",ae,r(o.translate("owner")),1),e("div",ie,[a(d,{type:"text",name:"owner",class:"form-control form-control-lg form-control-solid",placeholder:o.translate("owner"),modelValue:o.newItem.owner,"onUpdate:modelValue":n[2]||(n[2]=l=>o.newItem.owner=l)},null,8,["placeholder","modelValue"]),e("div",re,[e("div",de,[a(c,{name:"owner"})])])])]),e("div",ce,[e("label",me,r(o.translate("representative")),1),e("div",ue,[a(d,{type:"text",name:"representative",class:"form-control form-control-lg form-control-solid",placeholder:o.translate("representative"),modelValue:o.newItem.representative,"onUpdate:modelValue":n[3]||(n[3]=l=>o.newItem.representative=l)},null,8,["placeholder","modelValue"]),e("div",pe,[e("div",ve,[a(c,{name:"representative"})])])])]),e("div",_e,[e("label",fe,r(o.translate("licenseno")),1),e("div",be,[a(d,{type:"text",name:"permitno",class:"form-control form-control-lg form-control-solid mb-3 mb-lg-0",placeholder:o.translate("permitno"),modelValue:o.newItem.permitno,"onUpdate:modelValue":n[4]||(n[4]=l=>o.newItem.permitno=l)},null,8,["placeholder","modelValue"]),e("div",ge,[e("div",he,[a(c,{name:"permitno"})])])])]),e("div",we,[e("button",{type:"button",class:"btn btn-sm btn-flex btn-light-primary",onClick:n[5]||(n[5]=(...l)=>o.add&&o.add(...l))},[e("span",ye,[a(t,{src:"/media/icons/duotune/general/gen035.svg"})]),$(" "+r(o.translate("addfields")),1)])]),(g(!0),b(q,null,C(o.newItem.fields,(l,m)=>(g(),b("div",{key:m},[e("div",Ve,[e("label",ke,r(o.translate("list")),1),e("div",Ie,[a(d,{id:`list${m}`,type:"text",name:`list${m}`,class:"form-control form-control-lg required form-control-solid",placeholder:o.translate("list"),modelValue:l.property_list,"onUpdate:modelValue":v=>l.property_list=v},null,8,["id","name","placeholder","modelValue","onUpdate:modelValue"]),e("div",qe,[e("div",Ce,[a(c,{name:"list"})])])])]),e("div",$e,[e("label",Se,r(o.translate("noofpeople")),1),e("div",Fe,[a(d,{id:`noofpeople${m}`,type:"text",name:`noofpeople${m}`,class:"form-control form-control-lg required form-control-solid",placeholder:o.translate("noofpeople"),modelValue:l.no_of_people,"onUpdate:modelValue":v=>l.no_of_people=v},null,8,["id","name","placeholder","modelValue","onUpdate:modelValue"]),e("div",Ue,[e("div",Ne,[a(c,{name:"noofpeople"})])])])]),e("span",{class:"badge badge-pill mb-5",onClick:v=>o.deletefields(l.id,m)},Pe,8,Ae)]))),128))]),e("div",Te,[e("button",Re,r(o.translate("discard")),1),e("button",Ee,[e("span",Me,r(o.translate("save")),1),e("span",De,[$(r(o.translate("pleasewait"))+" ",1),je])],512)])]),_:1},8,["validation-schema"])])])}const Oe=G(L,[["render",Ge]]);export{Oe as default};
