import{D as A}from"./KTDataTable.c04eda30.js";import{h as N}from"./dom.d7d6c49b.js";import{S as $}from"./sweetalert2.all.fbc178e9.js";import{d as T,r,u as D,G as S,_ as I,k,l as o,I as l,m as b,y as i,ae as P,p as y,n as C,H as h,B as E,o as R,V as M,ao as O,F as q}from"./index.40c6202a.js";import{a as F}from"./index.30a6773f.js";const H=T({name:"change-password-modal",components:{},props:["items","id"],setup(e){console.log("props",e.id);const n=r(null),f=r(null),m=r(!1);r(!1);const{t:c,te:w}=D(),s=g=>w(g)?c(g):g,d=r({newpassword:""}),t=r({category:[{required:!0,message:s("passreq"),trigger:"change"}]});return{cancelprocess:()=>{d.value.newpassword="",N(f.value)},savecategory:()=>{!n.value||n.value.validate(g=>{g&&(m.value=!0,S.post("changePassword",{password:d.value.newpassword,id:e.id}).then(({data:L})=>{setTimeout(()=>{var B;m.value=!1,d.value={newpassword:""},(B=n.value)==null||B.resetFields("category"),$.fire({text:s("savesuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:s("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{N(f.value)})},2e3)}))})},rules:t,formRef:n,loading:m,changePasswodModalRef:f,password:d,translate:s}}}),G={class:"modal fade",id:"kt_modal_change_password",ref:"changePasswodModalRef",tabindex:"-1","aria-hidden":"true"},U={class:"modal-dialog modal-dialog-centered mw-650px"},j={class:"modal-content"},z={class:"modal-header",id:"kt_modal_add_customer_header"},J={class:"fw-bold"},K={id:"kt_modal_change_password_close","data-bs-dismiss":"modal",class:"btn btn-icon btn-sm btn-active-icon-primary"},Q={class:"svg-icon svg-icon-1"},X={class:"modal-body py-10 px-lg-17"},Y={class:"scroll-y me-n7 pe-7",id:"kt_modal_change_password_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_change_password_header","data-kt-scroll-wrappers":"#kt_modal_change_password_scroll","data-kt-scroll-offset":"300px"},Z={class:"fv-row mb-7"},x={class:"required fs-6 fw-semobold mb-2"},ee={class:"modal-footer flex-center"},te=["data-kt-indicator"],se={key:0,class:"indicator-label"},oe={class:"svg-icon svg-icon-3 ms-2 me-0"},ae={key:1,class:"indicator-progress"},ne=o("span",{class:"spinner-border spinner-border-sm align-middle ms-2"},null,-1);function le(e,n,f,m,c,w){const s=y("inline-svg"),d=y("el-input"),t=y("el-form-item"),u=y("el-form");return C(),k("div",G,[o("div",U,[o("div",j,[o("div",z,[o("h2",J,l(e.translate("changepassword")),1),o("div",K,[o("span",Q,[b(s,{src:"/media/icons/duotune/arrows/arr061.svg"})])])]),b(u,{onSubmit:n[2]||(n[2]=P(_=>e.savecategory(),["prevent"])),model:e.password,rules:e.rules,ref:"formRef"},{default:i(()=>[o("div",X,[o("div",Y,[o("div",Z,[o("label",x,l(e.translate("newpassword")),1),b(t,{prop:"newpassword"},{default:i(()=>[b(d,{modelValue:e.password.newpassword,"onUpdate:modelValue":n[0]||(n[0]=_=>e.password.newpassword=_),type:"text",name:"password",placeholder:e.translate("enterpassword")},null,8,["modelValue","placeholder"])]),_:1})])])]),o("div",ee,[o("button",{type:"reset",id:"kt_modal_change_password_cancel",class:"btn btn-light me-3",onClick:n[1]||(n[1]=(..._)=>e.cancelprocess&&e.cancelprocess(..._))},l(e.translate("cancel")),1),o("button",{"data-kt-indicator":e.loading?"on":null,class:"btn btn-lg btn-primary",type:"submit"},[e.loading?E("",!0):(C(),k("span",se,[h(l(e.translate("save"))+" ",1),o("span",oe,[b(s,{src:"/media/icons/duotune/arrows/arr064.svg"})])])),e.loading?(C(),k("span",ae,[h(l(e.translate("pleasewait"))+" ",1),ne])):E("",!0)],8,te)])]),_:1},8,["model","rules"])])])],512)}const re=I(H,[["render",le]]),ie=T({name:"usersupdate",components:{Datatable:A,ChangePasswordModal:re},setup(){const e=r([{columnName:"firstname",columnLabel:"firstname",sortEnabled:!0,columnWidth:175},{columnName:"lastname",columnLabel:"lastname",sortEnabled:!0,columnWidth:200},{columnName:"mobile",columnLabel:"mobile",sortEnabled:!0,columnWidth:200},{columnName:"nationality",columnLabel:"nationality",sortEnabled:!0,columnWidth:200},{columnName:"e_mail",columnLabel:"email",sortEnabled:!0,columnWidth:170},{columnName:"function",columnLabel:"role",sortEnabled:!0,columnWidth:170},{columnName:"validity",columnLabel:"validity",sortEnabled:!0,columnWidth:50},{columnName:"status",columnLabel:"status",sortEnabled:!0,columnWidth:50},{columnName:"action",columnLabel:"action",sortEnabled:!0,columnWidth:100}]),{t:n,te:f}=D();r(1);const m=r([]),c=r([]),w=r(""),s=a=>f(a)?n(a):a;R(()=>{S.get("showAllClientsData").then(({data:a})=>{c.value=a.data})});const d=a=>{M.push({name:"permissions",params:{user_id:a}})},t=(a,p)=>{let v="0";a=="0"?v="1":v="0",S.post("changeStatus",{status:v,id:p}).then(({data:W})=>{setTimeout(()=>{$.fire({text:s("savedsuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:s("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{M.go(0)})},2e3)})},u=(a,p)=>{$.fire({title:s("areyousure"),text:s("notretrivedata"),icon:"warning",buttonsStyling:!1,showCancelButton:!0,confirmButtonText:s("yesdelete"),cancelButtonText:s("nocancel"),heightAuto:!1,customClass:{confirmButton:"btn btn-danger m-2",cancelButton:"btn btn-primary m-2"}}).then(v=>{v.value==!0?S.post("isDeleteClient",{delete:1,id:p}).then(({data:W})=>{c.value=c.value.filter(V=>V.id!==p),setTimeout(()=>{$.fire({text:s("deletesuccess"),icon:"success",buttonsStyling:!1,confirmButtonText:s("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{})},500)}):setTimeout(()=>{$.fire({text:s("cancelerror"),icon:"success",buttonsStyling:!1,confirmButtonText:s("okgotit"),heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{})},500)})},_=a=>{console.log("id",a),w.value=a;const p=document.getElementById("kt_modal_change_password");new O(p).show()},g=r("");return{tableData:c,tableHeader:e,gotopage:d,search:g,selectedIds:m,deleterow:u,sort:a=>{const p=a.order==="asc";a.label&&F(c.value,a.label,{reverse:p})},onItemSelect:a=>{m.value=a},translate:s,statuschange:t,passwordReset:_,editid:w}}}),de={class:"card pt-6"},ce={class:"card-body pt-0"},ue=["onClick"],me=["onClick"],pe=["onClick"],he=["onClick"],fe=["onClick"];function _e(e,n,f,m,c,w){const s=y("Datatable"),d=y("ChangePasswordModal");return C(),k(q,null,[o("div",de,[o("div",ce,[b(s,{onOnSort:e.sort,onOnItemsSelect:e.onItemSelect,data:e.tableData,header:e.tableHeader,"enable-items-per-page-dropdown":!0},{firstname:i(({row:t})=>[h(l(t.firstname),1)]),lastname:i(({row:t})=>[h(l(t.lastname),1)]),mobile:i(({row:t})=>[h(l(t.mobile),1)]),nationality:i(({row:t})=>[h(l(t.nationality),1)]),email:i(({row:t})=>[h(l(t.email),1)]),role:i(({row:t})=>[h(l(t.role),1)]),validity:i(({row:t})=>[o("button",{onClick:u=>e.gotopage(t.id),class:"btn btn-sm btn-light btn-active-light-primary"},l(e.translate("powers")),9,ue)]),status:i(({row:t})=>[t.status==1?(C(),k("i",{key:0,class:"fa fa-unlock text-success fs-3","aria-hidden":"true",onClick:u=>e.statuschange(t.status,t.id)},null,8,me)):(C(),k("i",{key:1,class:"fa fa-lock text-danger fs-3","aria-hidden":"true",onClick:u=>e.statuschange(t.status,t.id)},null,8,pe))]),action:i(({row:t})=>[o("i",{class:"fa fa-key text-warning fs-3 m-2","aria-hidden":"true",onClick:u=>e.passwordReset(t.id)},null,8,he),o("i",{class:"fa fa-trash text-danger fs-3 m-2","aria-hidden":"true",onClick:u=>e.deleterow(t.is_deleted,t.id)},null,8,fe)]),_:1},8,["onOnSort","onOnItemsSelect","data","header"])])]),b(d,{id:e.editid},null,8,["id"])],64)}const ke=I(ie,[["render",_e]]);export{ke as default};
